vjust = -0.5,
size = 5
) +
labs(
title = "Bootstrap distribution",
x = "\nNumber of trips with ≥1 delay",
y = "Frequency\n"
) +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(
data = subset(df, successes == 5),
aes(x = 5, y = ..count.., label = paste0("p ≈ ", round(result$p_value_boot, 4))), stat = "count", vjust = -0.5, size = 4) +
labs(title = "", x = "\nNumber of trips with ≥1 delay", y = "Frequency\n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_x_continuous(breaks = 1)
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(
data = subset(df, successes == 5),
aes(x = 5, y = ..count.., label = paste0("p ≈ ", round(result$p_value_boot, 4))), stat = "count", vjust = -0.5, size = 4) +
labs(title = "", x = "\nNumber of trips with ≥1 delay", y = "Frequency\n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(
data = subset(df, successes == 5),
aes(x = 5, y = ..count.., label = paste0("p ≈ ", round(result$p_value_boot, 4))), stat = "count", vjust = -0.5, size = 4) +
labs(title = "", x = "\nNumber of trips with ≥1 delay", y = "Frequency\n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(x = 5, y = ..count.., label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 1:5) +
labs(title = "", x = "\nNumber of trips with ≥1 delay", y = "Frequency\n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(x = 5, y = ..count.., label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "", x = "\nNumber of trips with ≥1 delay", y = "Frequency\n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "", x = "\nNumber of trips with ≥1 delay", y = "Frequency\n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))), vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "", x = "\nNumber of trips with ≥1 delay", y = "Frequency\n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "", x = "\nNumber of trips with ≥1 delay", y = "Frequency\n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "각 여행의 지연 확률이 평균 0.1667 에서 ±10%p 정도 변동하는 베타 분포를 따른다 가정 했을 때 ", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Assuming that the delay probability for each trip follows a Beta distribution with a mean of 0.1667 and a variation of about ±10%.", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Assuming that the delay probability for each trip follows a Beta distribution", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Assuming that the delay probability for each trip follows a Beta distribution with $\mu$ 0.1667 and a variation of about ±10%.", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Assuming that the delay probability for each trip follows a Beta distribution.", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Assuming that the delay probability for each trip follows a Beta distribution", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Assuming the delay probability for each trip follows a Beta distribution", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 5) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Assuming the delay probability for each trip follows a Beta distribution", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 5) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Assuming the delay probability for each trip follows a Beta distribution", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Assuming the delay probability for each trip follows a Beta distribution", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Parametric Bootstrapping",subtitle = "Assuming the delay probability for each trip follows a Beta distribution", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Parametric Bootstrapping",subtitle = "Assuming the delay probability for each trip follows a Beta distribution (mean = 0.167, var = 0.01)", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Parametric Bootstrapping",subtitle = "Assuming the delay probability for each trip follows a Beta distribution (E(X) = 0.167, var = 0.01)", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Parametric Bootstrapping Results",subtitle = "Assuming the delay probability for each trip follows a Beta distribution (E(X) = 0.167, var = 0.01)", x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 3, beta = 15, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Parametric Bootstrapping Results",
subtitle = "Assuming the delay probability for each trip follows a Beta distribution (E(X) = 0.167, var = 0.01)",
x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2c, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes >= obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Parametric Bootstrapping Results",
subtitle = "Assuming the delay probability for each trip follows a Beta distribution (E(X) = 0.167, var = 0.01)",
x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
sim1 <- function(alpha = 2, beta = 10, n_per_trip = 4, n_trips = 5, B = 10000) {
set.seed(43)
successes <- replicate(B, {
p_trip <- rbeta(n_trips, alpha, beta)
x <- rbinom(n_trips, size = n_per_trip, prob = p_trip)
sum(x >= 1)})
obs <- n_trips
p_val <- mean(successes == obs)
list(p_value_boot = p_val, successes = successes)}
result <- sim1()
df <- data.frame(successes = result$successes)
ggplot(df, aes(x = successes, fill = successes == 5)) +
geom_histogram(binwidth = 1, color = "black", boundary = -0.5) +
scale_fill_manual(values = c("TRUE" = "tomato", "FALSE" = "lightblue"), guide = "none") +
geom_text(data = subset(df, successes == 5),
aes(label = paste0("p ≈ ", round(result$p_value_boot, 4))),
stat = "count", vjust = -0.5, size = 4) +
scale_x_continuous(breaks = 0:5) +
labs(title = "Parametric Bootstrapping Results",
subtitle = "Assuming the delay probability for each trip follows a Beta distribution (E(X) = 0.167, var = 0.01)",
x = "\n Number of trips with ≥1 delay", y = "Frequency \n") +
theme_minimal()
