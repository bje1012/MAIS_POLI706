---
title: "**POLI706: Advanced Methods of Political Analysis**"
subtitle: |
          | 
          | Problem set 8
          |
documentclass: article
format: 
  pdf:
    citation_package: natbib
    keep_tex: true
    fig_caption: true
    latex_engine: xelatex
    code-block-bg: light
    code-block-border-left: "#31BAE9"
    linkcolor: highlight
    urlcolor: highlight
    highlight-style: atom-one
#bibliography: W2.bib
header-includes:
  -  \usepackage{hyperref}
  -  \usepackage{mathpazo}
  -  \usepackage{bookmark}
  -  \definecolor{light}{HTML}{EEEEEE}
  -  \definecolor{highlight}{HTML}{9A2A2A}
  -  \definecolor{dark}{HTML}{330033}
  -  \usepackage{setspace}\singlespacing
  -  \usepackage{fvextra}
  -  \setmainfont[ItalicFont = {TeXGyrePagella-Italic}]{TeX Gyre Pagella}
  -  \DefineVerbatimEnvironment{Highlighting}{Verbatim}{breaklines,commandchars=\\\{\}}
  #-  \setmonofont{Fira Code}[Contextuals=Alternate]
  -  \makeatletter
  -  \renewcommand*\verbatim@nolig@list{}
  -  \makeatother
# You have to install fira font and tex gyre pagella
biblio-style: apsr
geometry: margin=1in
#fontfamily: mathpazo
fontsize: 11pt
link-citation: true
indent: true
---

```{r}
#| include: false
knitr::opts_chunk$set(echo = TRUE, eval = FALSE, error = FALSE, 
                      message = FALSE, warning = FALSE)
# Load packages to import data
library(knitr);library(patchwork);library(tidyverse)
theme_set(theme_bw())
```

This assignment allows you to explore and present your understanding of key concepts related to different types of variables and their interrelationships. 

+ First, run the following R codes and load necessary packages to use.

  ```{r}
  #| eval: true
  library(broom);library(tidyverse)
  if (!require("devtools")) install.packages("devtools")
  if (!require("vdemdata")) devtools::install_github("https://github.com/vdeminstitute/vdemdata")
  vdemdata::vdem |> as_tibble() -> vdem_df
  ```
  
+ Subset the sample as follows:
  
  ```{r}
  #| eval: true
  # Subset the sample data
  vdem_df |> 
    dplyr::select(country_name, COWcode, year, 
                  v2x_polyarchy, e_boix_regime, e_gdppc) |>
    dplyr::filter(year == 2015) -> sample
    
  sample |> 
    mutate(e_boix_regime = 
            factor(e_boix_regime, levels = c(0, 1), 
                                  labels = c("Autocracy", "Democracy"))) ->
                                  sample_fct
  ```

Collaborate and discuss extensively, write exclusively in your own voice. You can find readings from the learning module.

## Exercise 1

Aside from the ID variables (i.e., `country_name`, `COWcode`, `year`), explain what each variable is capturing, and its level of measurement (if numerical, explain whether it is discrete or continuous, and whether it is a ratio variable).

\noindent Hint: You will need the codebook. Googling the variable name takes you right to a useful webpage ([https://v-dem.net/documents/38/V-Dem_Codebook_v14.pdf](https://v-dem.net/documents/38/V-Dem_Codebook_v14.pdf)).

## Exercise 2

Using the sample data, specify a regression model in the form of, $y = \beta_0 + \beta_1x_1 + \beta_2 x_2 + u$, where $y$ is your outcome--GDP per capita (`e_gdppc`), and $x_1$ is Electoral Democracy Index (`v2x_polyarchy`) and $x_2$ is Dichotomous measurement of democracy (`e_boix_regime`).

a. Explain the models in detail.

b. Estimate the intercept, slopes, standard errors (all!), and variance of the error. Describe each item in a short write-up. Make all comparisons between these quantities that make sense. 

c. Describe what the plot below suggests. Do you really care what $\beta_1$ and $\beta_2$ are? How are they different? 

\vspace{1em}

```{r}
#| eval: true
#| echo: false
#| warning: false
#| message: false
#| error: false
model_fit <- 
  lm(e_gdppc ~ v2x_polyarchy + e_boix_regime, data = sample_fct)

model_fit |> broom::augment() |> as.data.frame() |> 
  ggplot(aes(x = v2x_polyarchy, y = e_gdppc, color = e_boix_regime)) +
  geom_point() +
  geom_abline(intercept= coef(model_fit)[1], 
              slope=coef(model_fit)[2], color=futurevisions::futurevisions("mars")[1], 
              size = 0.8) +
  geom_abline(intercept= coef(model_fit)[1] + coef(model_fit)[3], 
              slope=coef(model_fit)[2], color=futurevisions::futurevisions("mars")[3], 
              size = 0.8) +
  labs(y = "Estimated GDP per Capita\n", x = "\nElectoral Democracy Index") +
  scale_color_manual(values = c(futurevisions::futurevisions("mars")[1],
                                futurevisions::futurevisions("mars")[3])) +
  scale_y_continuous(limits = c(-5, 25), breaks = c(seq(-5, 25, 5))) +
  geom_vline(xintercept = 0, linetype = "dotted", "black") +
  theme(legend.title = element_blank(),
        legend.position = "top")
```
