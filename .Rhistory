data(income)
income$assignment <- complete_ra(N = nrow(income), prob = 0.5)
# Define income ranges for each bracket
income_ranges <- list(
"-10.000)" = c(0, 9999),
"[10.000-15.000)" = c(10000, 14999),
"[15.000-20.000)" = c(15000, 19999),
"[20.000-25.000)" = c(20000, 24999),
"[25.000-30.000)" = c(25000, 29999),
"[30.000-40.000)" = c(30000, 39999),
"[40.000-50.000)" = c(40000, 49999),
"[50.000-75.000)" = c(50000, 74999),
"[75.000-" = c(75000, 100000)  # assume upper bound for open-ended
)
# Convert INCOME to character if not already
income$INCOME <- as.character(income$INCOME)
# Function to randomly draw income within the specified range
random_income <- function(bracket) {
range <- income_ranges[[bracket]]
runif(1, min = range[1], max = range[2])
}
# Apply random income assignment based on bracket
set.seed(123)  # for reproducibility
income$Income_t1 <- sapply(income$INCOME, random_income)
set.seed(124)
income$Income_t2 <- ifelse(
income$assignment == 1,
income$Income_t1 + runif(sum(income$assignment == 1), min = 1000, max = 5000),
income$Income_t1
)
income$Income_t1_range <- income$INCOME
income <- income %>% select(Income_t1, Income_t1_range, assignment, Income_t2, everything(), - INCOME) %>% drop_na()
write_csv(income, "population.csv")
View(income)
# Import the dataset
read.csv("population.csv")
# View the first few rows
head(income[c("Income_t1", "Income_t2", "assignment", "SEX", "EDUCATION", "ETHNIC.CLASS")], 5) %>%
kable() %>%
kable_styling(full_width = TRUE, bootstrap_options = c("striped", "hover"))
# View the first few rows
head(population[c("Income_t1", "Income_t2", "assignment", "SEX", "EDUCATION", "ETHNIC.CLASS")], 5) %>%
kable() %>%
kable_styling(full_width = TRUE, bootstrap_options = c("striped", "hover"))
# Import the dataset
population <- read.csv("population.csv")
# View the first few rows
head(population[c("Income_t1", "Income_t2", "assignment", "SEX", "EDUCATION", "ETHNIC.CLASS")], 5) %>%
kable() %>%
kable_styling(full_width = TRUE, bootstrap_options = c("striped", "hover"))
library(tidyverse)
library(dplyr)
library(scales)
p1 <- income %>%
group_by(assignment, Income_t1_range) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = Income_t1_range, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y= "Count", x = "\nIncome (t1)") +
ggtitle("Distribution of Income (t1)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none") +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p2 <- income %>%
drop_na(EDUCATION) %>%
group_by(assignment, EDUCATION) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = EDUCATION, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "\nEducation Level") +
ggtitle("Distribution of EDUCATION") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p3 <- income %>%
drop_na(ETHNIC.CLASS) %>%
group_by(assignment, ETHNIC.CLASS) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = ETHNIC.CLASS, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "Count", x = "\n Ethnic Class") +
ggtitle("Distribution of ETHNIC CLASS") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none") +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p4 <- income %>%
drop_na(HOUSEHOLD.SIZE) %>%
group_by(assignment, HOUSEHOLD.SIZE) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = HOUSEHOLD.SIZE, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "\n Household Size") +
ggtitle("Distribution of Household Size") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
library(patchwork)
p1 + p2 + p3 + p4
library(tidyverse)
library(dplyr)
library(scales)
p1 <- income %>%
group_by(assignment, Income_t1_range) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = Income_t1_range, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y= "Count", x = "\nIncome (t1)") +
ggtitle("Distribution of Income (t1)") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none") +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p2 <- income %>%
drop_na(EDUCATION) %>%
group_by(assignment, EDUCATION) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = EDUCATION, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "\nEducation Level") +
ggtitle("Distribution of EDUCATION") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p3 <- income %>%
drop_na(ETHNIC.CLASS) %>%
group_by(assignment, ETHNIC.CLASS) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = ETHNIC.CLASS, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "Count", x = "\n Ethnic Class") +
ggtitle("Distribution of ETHNIC CLASS") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none") +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p4 <- income %>%
drop_na(HOUSEHOLD.SIZE) %>%
group_by(assignment, HOUSEHOLD.SIZE) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = HOUSEHOLD.SIZE, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "\n Household Size") +
ggtitle("Distribution of Household Size") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
library(patchwork)
p1 + p2 + p3 + p4
income %>%
group_by(assignment, Income_t1_range) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = Income_t1_range, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y= "Count", x = "\nIncome (t1)") +
ggtitle("Distribution of Income (t1)") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none") +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
library(tidyverse)
library(dplyr)
library(scales)
p1 <- income %>%
group_by(assignment, Income_t1_range) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = Income_t1_range, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y= "Count", x = "\nIncome (t1)") +
ggtitle("Distribution of Income (t1)") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none") +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p2 <- income %>%
drop_na(EDUCATION) %>%
group_by(assignment, EDUCATION) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = EDUCATION, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "\nEducation Level") +
ggtitle("Distribution of EDUCATION") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p3 <- income %>%
drop_na(ETHNIC.CLASS) %>%
group_by(assignment, ETHNIC.CLASS) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = ETHNIC.CLASS, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "Count", x = "\n Ethnic Class") +
ggtitle("Distribution of ETHNIC CLASS") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none") +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p4 <- income %>%
drop_na(HOUSEHOLD.SIZE) %>%
group_by(assignment, HOUSEHOLD.SIZE) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = HOUSEHOLD.SIZE, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "\n Household Size") +
ggtitle("Distribution of Household Size") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
library(patchwork)
p1 + p2 + p3 + p4
library(tidyverse)
library(dplyr)
library(scales)
p1 <- population %>%
group_by(assignment, Income_t1_range) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = Income_t1_range, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y= "Count", x = "\nIncome (t1)") +
ggtitle("Distribution of Income (t1)") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none") +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p2 <- population %>%
group_by(assignment, EDUCATION) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = EDUCATION, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "\nEducation Level") +
ggtitle("Distribution of EDUCATION") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p3 <- population %>%
group_by(assignment, ETHNIC.CLASS) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = ETHNIC.CLASS, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "Count", x = "\n Ethnic Class") +
ggtitle("Distribution of ETHNIC CLASS") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none") +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p4 <- population %>%
group_by(assignment, HOUSEHOLD.SIZE) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = HOUSEHOLD.SIZE, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "\n Household Size") +
ggtitle("Distribution of Household Size") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
library(patchwork)
p1 + p2 + p3 + p4
population %>%
group_by(assignment) %>%
summarise(mean_income = mean(Income_t2, na.rm = TRUE))
population %>%
group_by(assignment, Income_t1_range) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = Income_t1_range, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y= "Count", x = "\nIncome (t1)") +
ggtitle("Distribution of Income (t1)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
library(tidyverse)
library(dplyr)
library(scales)
p1 <- population %>%
group_by(assignment, Income_t1_range) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = Income_t1_range, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y= "Count", x = "") +
ggtitle("Distribution of Income (t1)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p2 <- population %>%
group_by(assignment, EDUCATION) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = EDUCATION, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "") +
ggtitle("Distribution of EDUCATION") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p3 <- population %>%
group_by(assignment, ETHNIC.CLASS) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = ETHNIC.CLASS, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "Count", x = "") +
ggtitle("Distribution of ETHNIC CLASS") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none") +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p4 <- population %>%
group_by(assignment, HOUSEHOLD.SIZE) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = HOUSEHOLD.SIZE, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "") +
ggtitle("Distribution of Household Size") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
library(patchwork)
p1 + p2 + p3 + p4
population %>%
group_by(assignment) %>%
summarise(mean_income = mean(Income_t2, na.rm = TRUE))
View(income)
View(income)
library(tidyverse)
library(dplyr)
library(scales)
p1 <- population %>%
group_by(assignment, Income_t1_range) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = Income_t1_range, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y= "Count", x = "") +
ggtitle("Distribution of Income (t1)") +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none",
axis.text.x = element_text(angle = 45, hjust = 1)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p2 <- population %>%
group_by(assignment, EDUCATION) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = EDUCATION, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "") +
ggtitle("Distribution of EDUCATION") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p3 <- population %>%
group_by(assignment, ETHNIC.CLASS) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = ETHNIC.CLASS, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "Count", x = "") +
ggtitle("Distribution of ETHNIC CLASS") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5), legend.position = "none") +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
p4 <- population %>%
group_by(assignment, HOUSEHOLD.SIZE) %>%
summarise(count = n(), .groups = "drop") %>%
group_by(assignment) %>%
ggplot(aes(x = HOUSEHOLD.SIZE, y = count, fill = factor(assignment))) +
geom_bar(stat = "identity", position = "dodge") +
labs(y = "", x = "") +
ggtitle("Distribution of Household Size") +
scale_x_discrete(labels = label_wrap(10)) +
theme_minimal() +
theme(plot.title = element_text(hjust = 0.5)) +
scale_fill_manual(
name = "Assignment",
values = c("0" = "#619CFF", "1" = "#F8766D"),
labels = c("0" = "Control", "1" = "Treatment")
)
library(patchwork)
p1 + p2 + p3 + p4
